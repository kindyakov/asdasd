"use strict";(self.webpackChunkgulp2023=self.webpackChunkgulp2023||[]).push([[227,829],{1037:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(8868),r=a(182);const n=class{constructor(e,t={}){const a={minRotation:0,maxRotation:0,color:"#64748b",font:{size:14,weight:500,family:"Manrope"}},n={options:{scales:{x:{ticks:a,border:{width:0},grid:{color:"#f3f3f3",lineWidth:1}},y:{ticks:a,grid:{color:"#f3f3f3",lineWidth:1},border:{width:0}}},plugins:{legend:{display:!1},tooltip:{enabled:!1,external:function(e){const{chart:t,tooltip:a}=e,s=t.canvas.parentNode.querySelector(".chart-tooltip");if(!s)return;if(0===a.opacity)return void(s.style.opacity=0);const r=a.dataPoints[0].dataIndex,n=t.data.datasets[0],i=t.data.datasets[1];s.innerHTML=`<div><b style="background: ${n.color};"></b><span>${n.data[r]}</span></div>\n              <div><b style="background: ${i.color};"></b><span>${i.data[r]}</span></div>`,s.style.opacity=1,s.style.left=t.canvas.offsetLeft+a.caretX-s.clientWidth-6+"px",s.style.top=t.canvas.offsetTop+a.caretY-s.clientHeight-6+"px"}}},responsive:!0,maintainAspectRatio:!1}};this.chart=new s.Ay(e,r({},n,t)),window.addEventListener("resize",(()=>this.resizeChart()))}resizeChart(){this.chart&&this.chart.update("resize")}}},8829:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var s=a(6353),r=a(2302),n=a(3943);const i=class{constructor({loader:e,tables:t=[],charts:a=[],page:s}){this.loader=e,this.wrapper=document.querySelector(`[data-content="dashboards/${s}"]`),this.formFilter=this.wrapper.querySelector(".form-filter-dashboards"),this.tables=[],this.charts=[],t.length&&t.forEach((e=>{const{TableComponent:t,tableSelector:a,options:s={},params:r={}}=e;this.table=new t(a,{...s,wrapper:this.wrapper},r),this.tables.push(this.table)})),a.length&&a.forEach((e=>{const{id:t,ChartComponent:a,options:s={}}=e,r=new a(this.wrapper.querySelector(`#${t}`),s);this.charts.push(r)})),this.queryParams={},this.widgets=this.wrapper.querySelectorAll("[data-render-widget]"),this.init(s)}init(e){this.formFilter&&(this.selectFilter=new s.l({uniqueName:"select-filter-main",parentEl:this.wrapper}),this.calendars=(0,r.d)(`[data-content="dashboards/${e}"] .input-date-filter`,{mode:"range",dateFormat:"d. M, Y",onChange:(e,t,a)=>{2===e.length&&this.changeQueryParams({start_date:(0,n.p)(e[0],"YYYY-MM-DD"),end_date:(0,n.p)(e[1],"YYYY-MM-DD")})}})),this.events()}events(){this.tables.length&&this.actionsTables((e=>{e.onPageChange=t=>this.renderTable(e,{page:t}),e.onChangeTypeUser=({e:t,select:a,optionValue:s})=>this.renderTable(e,{user_type:s}),e.onValueInputSearch=t=>{""!==t?this.renderTable(e,{search_str:t}):this.renderTable(e)}})),this.selectFilter&&(this.selectFilter.onChange=(e,t,a)=>{const s=t.getAttribute("data-name"),r={[s]:a};this.changeQueryParams(r)})}changeQueryParams(e){this.queryParams={...this.queryParams,...e},this.renderDashboard(e)}renderWidgets(e){this.widgets.length&&this.widgets.forEach((t=>{const a=t.getAttribute("data-render-widget"),[s,r]=a.split(","),n=e[s]?e[s]+`${r||""}`:"В процессе доработки";e[s]||(t.style.fontSize="16px"),t.innerHTML=n}))}actionsTables(e=(()=>{})){if(!this.tables.length)return console.error("Нет таблиц");this.tables.forEach((t=>{e(t)}))}actionsCharts(e=(()=>{})){this.charts.length&&this.charts.forEach((t=>{e(t)}))}async render(){try{this.loader.enable();const[e,t]=await Promise.all([this.getDashboardData(),this.getData()]);e&&(this.renderWidgets(e),this.actionsCharts((t=>t.render(e)))),this.tables.length&&t&&this.actionsTables((e=>e.render(t)))}catch(e){console.error(e)}finally{this.loader.disable()}}async renderDashboard(e){try{this.loader.enable(),await this.getDashboardData(e)}catch(e){console.error(e)}finally{this.loader.disable()}}async renderTable(e,t={}){try{this.loader.enable();const a=await this.getData(t);e.render(a)}catch(e){console.error(e)}finally{this.loader.disable()}}}},3227:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var s=a(8829),r=a(3282),n=a(6047);class i extends r.A{constructor(e,t,a){const s={columnDefs:[{headerName:"Канал продаж",field:"",minWidth:120,flex:.6},{headerName:"Бюджет",field:"",minWidth:80,flex:.4,valueFormatter:e=>e.value?(0,n.F)(e.value):""},{headerName:"Все лиды",field:"",minWidth:80,flex:.4},{headerName:"Цена лида",field:"",minWidth:100,flex:.5,valueFormatter:e=>e.value?(0,n.F)(e.value):""},{headerName:"Количество сделок",field:"",minWidth:70,flex:.4},{headerName:"% конверсии",field:"",minWidth:80,flex:.5,valueFormatter:e=>e.value?e.value+"%":""},{headerName:"Выручка",field:"",minWidth:100,flex:.5,valueFormatter:e=>e.value?(0,n.F)(e.value):""},{headerName:"ROI",field:"",minWidth:80,flex:.4,resizable:!1,valueFormatter:e=>e.value?e.value+"%":""}]};super(e,Object.assign({},s,t),Object.assign({},{},a))}render(e){}}const l=i;var o=a(9244),d=a(2783);const h=class{constructor(){this.input=null,this.btnAdd=null,this.optionsTippy={allowHTML:!0,trigger:"click",maxWidth:300,duration:0,placement:"bottom-end",interactive:!0,appendTo:document.body,content:e=>{const t=(0,d.n)("div",[],'\n  <div class="filter">\n  <div class="filter__top">\n    <h4 class="filter__title">Добавить канал продаж</h4>\n  </div>\n  <div class="filter__content">\n    <div class="filter__block">\n      <span class="filter__block_name">Название канала:</span>\n      <div class="wp-input">\n        <input type="text" name="" class="input" autocomplete="off" placeholder="Введите название" style="height: 40px;">\n      </div>\n    </div>\n  </div>\n  <div class="filter__footer">\n    <button class="filter__button button btn-add"><span>Добавить</span></button>\n  </div>\n</div>');return this.input=t.querySelector(".input"),this.btnAdd=t.querySelector(".btn-add"),t}}}init(e){console.log(e),this.eGui=(0,d.n)("button",["btn-custom-th"],e.template),this.tippy=(0,o.Ay)(this.eGui,this.optionsTippy),this.events()}events(){this.input.addEventListener("input",this.handleInput.bind(this)),this.btnAdd.addEventListener("click",this.handleClickBtnAdd.bind(this))}getGui(){return this.eGui}handleInput(e){}handleClickBtnAdd(){this.tippy.hide()}},c=class{init(e){this.eGui=(0,d.n)("button",["btn-custom-th"],e.template)}getGui(){return this.eGui}};class p extends r.A{constructor(e,t,a){const s={columnDefs:[{headerName:"Канал продаж",field:"",minWidth:120,flex:.6,resizable:!1},{headerName:"Сумма затрат",field:"",minWidth:80,flex:.4,resizable:!1,valueFormatter:e=>e.value?(0,n.F)(e.value):""},{headerName:"",field:"",minWidth:40,width:40,resizable:!1,sortable:!1,headerComponentParams:{template:"<svg class='icon icon-edit' style=\"flex-shrink: 0; stroke: #000; width: 15px; height: 15px;\">\n                        <use xlink:href='img/svg/sprite.svg#edit'></use>\n                      </svg>"},headerComponent:c},{headerName:"",field:"",minWidth:40,width:40,resizable:!1,sortable:!1,headerComponentParams:{template:"<svg class='icon icon-plus' style=\"flex-shrink: 0; width: 10px; height: 10px;\">\n                        <use xlink:href='img/svg/sprite.svg#plus'></use>\n                      </svg>"},headerComponent:h}],pagination:!1};super(e,Object.assign({},s,t),Object.assign({},{isPagination:!1},a))}render(e){}}const u=p;var b=a(1037),g=a(182),f=a(6353);function m(e,t,a){return Array.from({length:e},(()=>Math.floor(Math.random()*(a-t+1))+t))}function v({data:e,label:t,color:a,gradient:s,params:r={}}){return{label:t,data:e,borderColor:a,color:a,pointBackgroundColor:"#fff",backgroundColor:s,pointRadius:0,fill:!0,tension:.6,...r}}class y extends b.A{constructor(e,t={}){const a={type:"line",data:{labels:Array.from({length:30},((e,t)=>t+1)),datasets:[v({data:m(30,20,30),label:"Яндекс директ",color:"#fac800",gradient:()=>{const t=e.getContext("2d").createLinearGradient(0,0,0,400);return t.addColorStop(0,"rgba(250, 200, 0, 0.1)"),t.addColorStop(1,"rgba(250, 200, 0, 0.01)"),t}}),v({data:m(30,15,25),label:"Вконтакте",color:"#11b880",gradient:()=>{const t=e.getContext("2d").createLinearGradient(0,0,0,400);return t.addColorStop(0,"rgba(17, 184, 128, 0.1)"),t.addColorStop(1,"rgba(17, 184, 128, 0.01)"),t}}),v({data:m(30,10,20),label:"Google Adsense",color:"#ff7628",gradient:()=>{const t=e.getContext("2d").createLinearGradient(0,0,0,400);return t.addColorStop(0,"rgba(255, 118, 40, 0.1)"),t.addColorStop(1,"rgba(255, 118, 40, 0.01)"),t}}),v({data:m(30,5,15),label:"Facebook",color:"#3D50E0",gradient:()=>{const t=e.getContext("2d").createLinearGradient(0,0,0,400);return t.addColorStop(0,"rgba(60, 80, 224, 0.1)"),t.addColorStop(1,"rgba(60, 80, 224, 0.01)"),t}}),v({data:m(30,1,2),label:"План",color:"#6f7d90",gradient:"transparent",params:{borderWidth:2,borderDash:[5,5],backgroundColor:"transparent"}})]},options:{scales:{x:{grid:{display:!1}},y:{beginAtZero:!0,grid:{borderDash:[5,5],color:"#e2e8f0"}}},plugins:{legend:{position:"top"},tooltip:{mode:"index",intersect:!0}}}};super(e,g({},a,t)),this.datasets={"":()=>{this.chart.data.datasets[0].hidden=!0,this.chart.data.datasets[1].hidden=!1,this.chart.update()},"":()=>{this.chart.data.datasets[0].hidden=!1,this.chart.data.datasets[1].hidden=!0,this.chart.update()},"":()=>{this.chart.data.datasets[0].hidden=!1,this.chart.data.datasets[1].hidden=!1,this.chart.update()}},this.selects=new f.l({uniqueName:"select-chart-sales-channels",selectMinWidth:155})}handleSelectChange(e,t,a){this.datasets[a]&&this.datasets[a]()}render(){}}const C=y;class x extends s.default{constructor({loader:e}){super({loader:e,tables:[{tableSelector:".table-sales-channels",TableComponent:l},{tableSelector:".table-sales-channels-edit",TableComponent:u}],charts:[{id:"chart-sales-channels",ChartComponent:C}],page:"sales-channels"})}async getData(e={}){return[]}async getDashboardData(){return[]}}const w=x}}]);