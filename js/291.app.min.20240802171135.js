"use strict";(self.webpackChunkgulp2023=self.webpackChunkgulp2023||[]).push([[291],{9291:(e,a,t)=>{t.r(a),t.d(a,{default:()=>n});var s=t(3943),r=t(1417);const n=class{constructor({loader:e,tables:a=[],page:t}){this.loader=e,this.wrapper=document.querySelector(`[data-content="${t}"]`),this.tables=[],a.length&&a.forEach((e=>{const{TableComponent:a,tableSelector:t,options:s={},params:r={}}=e;this.table=new a(t,{...s,wrapper:this.wrapper},r),this.tables.push(this.table)})),this.queryParams={},this.init(t)}onRender(){}init(e){this.events()}events(){this.tables.length&&this.actionsTables((e=>{e.onPageChange=a=>this.changeQueryParams({page:a},e),e.onValueInputSearch=a=>{let t={};t=""!==a?{search_str:a}:{},this.changeQueryParams(t,e)},e.selects.onChange=(a,t,s)=>{const r=t.getAttribute("data-name");this.changeQueryParams({[r]:s},e)},e.calendar&&(e.calendar.methods.onChange=(a,t,r)=>{if(2===a.length){const[t,n]=r.element.name.split(",");this.changeQueryParams({[t]:(0,s.p)(a[0],"YYYY-MM-DD"),[n]:(0,s.p)(a[1],"YYYY-MM-DD")},e)}})}))}changeQueryParams(e,a=null){this.queryParams=(0,r.$)(this.queryParams,e),a?this.renderTable(a,this.queryParams):this.render(this.queryParams)}actionsTables(e=(()=>{})){if(!this.tables.length)return console.error("Нет таблиц");this.tables.forEach((a=>{e(a)}))}async render(e={}){try{this.loader.enable();const a=await this.getData(e);this.tables.length&&a&&this.actionsTables((e=>e.render(a))),this.onRender(a)}catch(e){console.error(e)}finally{this.loader.disable()}}async renderTable(e,a={}){try{this.loader.enable();const t=await this.getData(a);e?.render(t)}catch(e){console.error(e)}finally{this.loader.disable()}}}}}]);